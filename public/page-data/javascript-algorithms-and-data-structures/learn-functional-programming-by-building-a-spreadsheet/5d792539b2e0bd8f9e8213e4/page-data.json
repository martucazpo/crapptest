{"componentChunkName":"component---src-templates-lesson-jsx","path":"/javascript-algorithms-and-data-structures/learn-functional-programming-by-building-a-spreadsheet/5d792539b2e0bd8f9e8213e4/","result":{"data":{"markdownRemark":{"id":"cd1a5e53-244b-5514-b50a-64f8674a0d9a","frontmatter":{"challengeType":0,"dashedName":"step-133","title":"Step 133","id":"5d792539b2e0bd8f9e8213e4"},"rawMarkdownBody":"\n# --description--\n\nUse the ternary operator to return `average([sorted[middle], sorted[middle + 1]])` if `length` is even, and `sorted[middle + 0.5]` otherwise.\n\nNote that the `middle` variable is close to the middle but is not actually the middle.\n\n# --hints--\n\nSee description above for instructions.\n\n```js\nassert(median([1, 20, 3]) === 3 && median([27, 7, 20, 10]) === 15);\n```\n\n# --seed--\n\n## --before-user-code--\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <title>Spreadsheet</title>\n  <style>\n    #container {\n      display: grid;\n      grid-template-columns: 50px repeat(10, 200px);\n      grid-template-rows: repeat(11, 30px);\n    }\n    .label {\n      background-color: lightgray;\n      text-align: center;\n      vertical-align: middle;\n      line-height: 30px;\n    }\n  </style>\n</head>\n<body>\n<div id=\"container\">\n  <div></div>\n</div>\n```\n\n## --after-user-code--\n\n```html\n</body>\n</html>\n```\n\n## --seed-contents--\n\n```html\n<script>\n\nconst infixToFunction = {\n  \"+\": (x, y) => x + y,\n  \"-\": (x, y) => x - y,\n  \"*\": (x, y) => x * y,\n  \"/\": (x, y) => x / y\n};\n\nconst infixEval = (str, regex) =>\n  str.replace(regex, (_, arg1, fn, arg2) =>\n    infixToFunction[fn](parseFloat(arg1), parseFloat(arg2))\n  );\n\nconst highPrecedence = str => {\n  const regex = /([0-9.]+)([*\\/])([0-9.]+)/;\n  const str2 = infixEval(str, regex);\n  return str === str2 ? str : highPrecedence(str2);\n};\n\nconst isEven = num => num % 2 === 0;\nconst sum = nums => nums.reduce((a, x) => a + x);\nconst average = nums => sum(nums) / nums.length;\n\n--fcc-editable-region--\nconst median = nums => {\n  const sorted = nums.slice().sort((x, y) => x - y);\n  const length = sorted.length;\n  const middle = sorted.length / 2 - 1;\n  return isEven(length);\n}; \n--fcc-editable-region--\n\n\n\nconst spreadsheetFunctions = {\n  \"\": x => x,\n  random: ([x, y]) => Math.floor(Math.random() * y + x),\n  increment: nums => nums.map(x => x + 1),\n  firsttwo: arr => arr.slice(0, 2),\n  lasttwo: arr => arr.slice(-2),\n  even: nums => nums.filter(isEven),\n  sum,\n  average,\n  has2: arr => arr.includes(2),\n  nodups: arr => arr.reduce((a, x) => a.includes(x) ? a : a.concat(x), []),\n  range: arr => range(...arr)\n};\n\nconst applyFn = str => {\n  const noHigh = highPrecedence(str);\n  const infix = /([0-9.]+)([+-])([0-9.]+)/;\n  const str2 = infixEval(noHigh, infix);\n  const regex = /([a-z]*)\\(([0-9., ]*)\\)(?!.*\\()/i;\n  const toNumberList = args => args.split(\",\").map(parseFloat);\n  const applyFunction = (fn, args) =>\n    spreadsheetFunctions[fn.toLowerCase()](toNumberList(args));\n  return str2.replace(\n    regex,\n    (match, fn, args) =>\n      spreadsheetFunctions.hasOwnProperty(fn.toLowerCase()) ? applyFunction(fn, args) : match\n  );\n};\n\nconst range = (start, end) =>\n  start > end ? [] : [start].concat(range(start + 1, end));\n\nconst charRange = (start, end) =>\n  range(start.charCodeAt(0), end.charCodeAt(0)).map(x =>\n    String.fromCharCode(x)\n  );\n\nconst evalFormula = (x, cells) => {\n  const idToText = id => cells.find(cell => cell.id === id).value;\n  const rangeRegex = /([A-J])([1-9][0-9]?):([A-J])([1-9][0-9]?)/gi;\n  const rangeFromString = (n1, n2) => range(parseInt(n1), parseInt(n2));\n  const elemValue = n => c => idToText(c + n);\n  const addChars = c1 => c2 => n => charRange(c1, c2).map(elemValue(n));\n  const varRangeExpanded = x.replace(rangeRegex, (_, c1, n1, c2, n2) =>\n    rangeFromString(n1, n2).map(addChars(c1)(c2))\n  );\n  const varRegex = /[A-J][1-9][0-9]?/gi;\n  const varExpanded = varRangeExpanded.replace(\n    varRegex,\n    match => idToText(match.toUpperCase())\n  );\n  const functionExpanded = applyFn(varExpanded);\n  return functionExpanded === x\n    ? functionExpanded\n    : evalFormula(functionExpanded, cells);\n};\n\nwindow.onload = () => {\n  const container = document.getElementById(\"container\");\n  const createLabel = name => {\n    const label = document.createElement(\"div\");\n    label.className = \"label\";\n    label.textContent = name;\n    container.appendChild(label);\n  };\n  const letters = charRange(\"A\", \"J\");\n  letters.forEach(createLabel);\n  range(1, 99).forEach(x => {\n    createLabel(x);\n    letters.forEach(y => {\n      const input = document.createElement(\"input\");\n      input.type = \"text\";\n      input.id = y + x;\n      input.onchange = update;\n      container.appendChild(input);\n    });\n  });\n};\n\nconst update = event => {\n  const element = event.target;\n  const value = element.value.replace(/\\s/g, \"\");\n  if (!value.includes(element.id) && value[0] === \"=\") {\n    element.value = evalFormula(\n      value.slice(1),\n      Array.from(document.getElementById(\"container\").children)\n    );\n  }\n};\n</script>\n```\n\n# --solutions--\n\n```html\n<script>\nconst infixToFunction = {\n  \"+\": (x, y) => x + y,\n  \"-\": (x, y) => x - y,\n  \"*\": (x, y) => x * y,\n  \"/\": (x, y) => x / y\n};\n\nconst infixEval = (str, regex) =>\n  str.replace(regex, (_, arg1, fn, arg2) =>\n    infixToFunction[fn](parseFloat(arg1), parseFloat(arg2))\n  );\n\nconst highPrecedence = str => {\n  const regex = /([0-9.]+)([*\\/])([0-9.]+)/;\n  const str2 = infixEval(str, regex);\n  return str === str2 ? str : highPrecedence(str2);\n};\n\nconst isEven = num => num % 2 === 0;\nconst sum = nums => nums.reduce((a, x) => a + x);\nconst average = nums => sum(nums) / nums.length;\n\nconst median = nums => {\n  const sorted = nums.slice().sort((x, y) => x - y);\n  const length = sorted.length;\n  const middle = sorted.length / 2 - 1;\n  return isEven(length)\n    ? average([sorted[middle], sorted[middle + 1]])\n    : sorted[middle + 0.5];\n}; \n\nconst spreadsheetFunctions = {\n  \"\": x => x,\n  random: ([x, y]) => Math.floor(Math.random() * y + x),\n  increment: nums => nums.map(x => x + 1),\n  firsttwo: arr => arr.slice(0, 2),\n  lasttwo: arr => arr.slice(-2),\n  even: nums => nums.filter(isEven),\n  sum,\n  average,\n  has2: arr => arr.includes(2),\n  nodups: arr => arr.reduce((a, x) => a.includes(x) ? a : a.concat(x), []),\n  range: arr => range(...arr)\n};\n\n\n\nconst applyFn = str => {\n  const noHigh = highPrecedence(str);\n  const infix = /([0-9.]+)([+-])([0-9.]+)/;\n  const str2 = infixEval(noHigh, infix);\n  const regex = /([a-z]*)\\(([0-9., ]*)\\)(?!.*\\()/i;\n  const toNumberList = args => args.split(\",\").map(parseFloat);\n  const applyFunction = (fn, args) =>\n    spreadsheetFunctions[fn.toLowerCase()](toNumberList(args));\n  return str2.replace(\n    regex,\n    (match, fn, args) =>\n      spreadsheetFunctions.hasOwnProperty(fn.toLowerCase()) ? applyFunction(fn, args) : match\n  );\n};\n\nconst range = (start, end) =>\n  start > end ? [] : [start].concat(range(start + 1, end));\n\nconst charRange = (start, end) =>\n  range(start.charCodeAt(0), end.charCodeAt(0)).map(x =>\n    String.fromCharCode(x)\n  );\n\nconst evalFormula = (x, cells) => {\n  const idToText = id => cells.find(cell => cell.id === id).value;\n  const rangeRegex = /([A-J])([1-9][0-9]?):([A-J])([1-9][0-9]?)/gi;\n  const rangeFromString = (n1, n2) => range(parseInt(n1), parseInt(n2));\n  const elemValue = n => c => idToText(c + n);\n  const addChars = c1 => c2 => n => charRange(c1, c2).map(elemValue(n));\n  const varRangeExpanded = x.replace(rangeRegex, (_, c1, n1, c2, n2) =>\n    rangeFromString(n1, n2).map(addChars(c1)(c2))\n  );\n  const varRegex = /[A-J][1-9][0-9]?/gi;\n  const varExpanded = varRangeExpanded.replace(\n    varRegex,\n    match => idToText(match.toUpperCase())\n  );\n  const functionExpanded = applyFn(varExpanded);\n  return functionExpanded === x\n    ? functionExpanded\n    : evalFormula(functionExpanded, cells);\n};\n\nwindow.onload = () => {\n  const container = document.getElementById(\"container\");\n  const createLabel = name => {\n    const label = document.createElement(\"div\");\n    label.className = \"label\";\n    label.textContent = name;\n    container.appendChild(label);\n  };\n  const letters = charRange(\"A\", \"J\");\n  letters.forEach(createLabel);\n  range(1, 99).forEach(x => {\n    createLabel(x);\n    letters.forEach(y => {\n      const input = document.createElement(\"input\");\n      input.type = \"text\";\n      input.id = y + x;\n      input.onchange = update;\n      container.appendChild(input);\n    });\n  });\n};\n\nconst update = event => {\n  const element = event.target;\n  const value = element.value.replace(/\\s/g, \"\");\n  if (!value.includes(element.id) && value[0] === \"=\") {\n    element.value = evalFormula(\n      value.slice(1),\n      Array.from(document.getElementById(\"container\").children)\n    );\n  }\n};\n</script>\n```\n"}},"pageContext":{"relativeDirectory":"javascript-algorithms-and-data-structures/learn-functional-programming-by-building-a-spreadsheet","id":"5d792539b2e0bd8f9e8213e4","dashedName":"step-133"}},"staticQueryHashes":["4279786174"],"slicesMap":{}}